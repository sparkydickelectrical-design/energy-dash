<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Master Hub | PeakShaving Pro</title>
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        :root {
            --bg: #000;
            --side-bg: #080808;
            --card: #0d0d0d;
            --green: #4ade80;
            --blue: #3b82f6;
            --red: #ef4444;
            --orange: #f97316;
        }

        body {
            background: var(--bg);
            color: #fff;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            margin: 0; display: flex; height: 100vh; overflow: hidden;
        }

        /* SIDEBAR */
        .sidebar {
            width: 75px; background: var(--side-bg); border-right: 1px solid #1a1a1a;
            display: flex; flex-direction: column; align-items: center; padding: 30px 0; flex-shrink: 0;
        }
        .side-logo { margin-bottom: 50px; }
        .side-links { display: flex; flex-direction: column; gap: 35px; flex-grow: 1; }
        .nav-item { color: #444; text-decoration: none; display: flex; flex-direction: column; align-items: center; gap: 5px; }
        .nav-item i { width: 22px; height: 22px; }
        .nav-item span { font-size: 0.5rem; font-weight: 800; }
        .nav-item.active { color: var(--blue); }

        /* MAIN CONTENT */
        .main-content { flex-grow: 1; overflow-y: auto; padding: 20px; scrollbar-width: none; }
        .main-content::-webkit-scrollbar { display: none; }

        .telemetry-bar { display: flex; flex-direction: column; gap: 10px; margin-bottom: 25px; border-bottom: 1px solid #111; padding-bottom: 15px; }
        .tel-row { display: flex; justify-content: space-between; align-items: center; }
        .tel-lbl { font-size: 0.85rem; color: #888; font-weight: 600; }
        .tel-val { font-weight: 900; font-size: 1rem; }

        /* RADIAL HUB */
        .radial-section { position: relative; height: 380px; width: 400px; margin: 0 auto 30px auto; }
        .radial-hub { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        .svg-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; }
        .dash-line { stroke: #333; stroke-width: 2.5; stroke-dasharray: 6; fill: none; }
        .anim-flow { animation: flowLine 10s linear infinite; }
        @keyframes flowLine { from { stroke-dashoffset: 100; } to { stroke-dashoffset: 0; } }

        /* NODES */
        .node-box { position: absolute; transform: translate(-50%, -50%); text-align: center; z-index: 10; width: 80px; }
        .node-circle {
            width: 62px; height: 62px; background: #000; border: 2px solid #222; border-radius: 50%;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            box-shadow: 0 0 20px rgba(0,0,0,0.5); transition: border-color 0.3s ease;
        }
        .node-circle i { width: 16px; height: 16px; color: #555; margin-bottom: 2px; transition: color 0.3s ease; }
        .node-circle .val { font-weight: 900; font-size: 0.85rem; line-height: 1; }
        .node-tag { font-size: 0.55rem; color: #666; font-weight: 800; margin-top: 8px; display: block; white-space: nowrap; }

        /* FIXED POSITION COORDINATES */
        .pos-center { top: 50%; left: 50%; }
        .pos-n1 { top: 12.5%; left: 50%; } /* Solar - Centered on top line */
        .pos-n2 { top: 25%; left: 83%; }  /* Wind */
        .pos-n3 { top: 55%; left: 88%; }  /* Storage */
        .pos-n4 { top: 85%; left: 70%; }  /* Home */
        .pos-n5 { top: 85%; left: 30%; }  /* EV */
        .pos-n6 { top: 55%; left: 12%; }  /* Heat Pump */
        .pos-n7 { top: 25%; left: 17.5%; } /* Grid */

        /* CONTROL PANEL */
        .control-panel { background: var(--card); border-radius: 20px; padding: 20px; border: 1px solid #1a1a1a; margin-bottom: 40px; }
        .control-panel h2 { font-size: 0.9rem; margin-bottom: 20px; color: var(--blue); text-transform: uppercase; letter-spacing: 1px; }
        .slider-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .slider-header { display: flex; justify-content: space-between; font-size: 0.7rem; margin-bottom: 8px; color: #888; font-weight: 700; }
        input[type=range] { width: 100%; cursor: pointer; accent-color: var(--blue); }

        /* STATES */
        .green-text { color: var(--green) !important; } 
        .red-text { color: var(--red) !important; }
        .blue-text { color: var(--blue); }
        .pulse-blue { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.4); animation: pulse 2s infinite; }
        @keyframes pulse { 70% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); } }
    </style>
</head>

<body>

    <aside class="sidebar">
        <div class="side-logo"><i data-lucide="zap" class="green-text"></i></div>
        <nav class="side-links">
            <a href="index.html" class="nav-item active"><i data-lucide="layout-dashboard"></i><span>HUB</span></a>
            <a href="#" class="nav-item"><i data-lucide="trending-up"></i><span>SAVINGS</span></a>
            <a href="#" class="nav-item"><i data-lucide="bar-chart-3"></i><span>DATA</span></a>
            <a href="#" class="nav-item"><i data-lucide="settings"></i><span>AUTO</span></a>
        </nav>
    </aside>

    <div class="main-content">
        <header class="telemetry-bar">
            <div class="tel-row"><span class="tel-lbl">Utility Balance</span><span class="tel-val" id="tel-grid">0.0 kW</span></div>
            <div class="tel-row"><span class="tel-lbl">Total Renewable Power</span><span class="tel-val green-text" id="tel-yield">0.0 kW</span></div>
        </header>

        <section class="radial-section">
            <div class="radial-hub">
                <svg class="svg-layer" viewBox="0 0 400 400">
                    <line x1="200" y1="200" x2="200" y2="50" class="dash-line anim-flow" />
                    <line x1="200" y1="200" x2="330" y2="100" class="dash-line anim-flow" />
                    <line x1="200" y1="200" x2="350" y2="220" class="dash-line anim-flow" />
                    <line x1="200" y1="200" x2="280" y2="340" class="dash-line anim-flow" />
                    <line x1="200" y1="200" x2="120" y2="340" class="dash-line anim-flow" />
                    <line x1="200" y1="200" x2="50" y2="220" class="dash-line anim-flow" />
                    <line x1="200" y1="200" x2="70" y2="100" class="dash-line anim-flow" />
                </svg>

                <div class="node-box pos-center"><div class="node-circle pulse-blue"><i data-lucide="cpu" class="blue-text"></i></div><span class="node-tag">HUB CORE</span></div>
                
                <div class="node-box pos-n1"><div class="node-circle" id="node-solar"><i data-lucide="sun"></i><span class="val">0.0</span></div><span class="node-tag">SOLAR PV</span></div>
                <div class="node-box pos-n2"><div class="node-circle" id="node-wind"><i data-lucide="wind"></i><span class="val">0.0</span></div><span class="node-tag">WIND YIELD</span></div>
                <div class="node-box pos-n3"><div class="node-circle" id="node-batt"><i data-lucide="battery"></i><span class="val">0.0</span></div><span class="node-tag">STORAGE</span></div>
                <div class="node-box pos-n4"><div class="node-circle" id="node-home" style="border-color: var(--blue)"><i data-lucide="home" style="color: var(--blue)"></i><span class="val">0.0</span></div><span class="node-tag">HOME LOAD</span></div>
                <div class="node-box pos-n5"><div class="node-circle" id="node-ev"><i data-lucide="car"></i><span class="val">0.0</span></div><span class="node-tag">EV CHARGER</span></div>
                <div class="node-box pos-n6"><div class="node-circle" id="node-hp"><i data-lucide="thermometer"></i><span class="val">0.0</span></div><span class="node-tag">HEAT PUMP</span></div>
                <div class="node-box pos-n7"><div class="node-circle" id="node-grid"><i data-lucide="utility-pole"></i><span class="val">0.0</span></div><span class="node-tag">UTILITY</span></div>
            </div>
        </section>

        <div class="control-panel">
            <h2>System Simulation</h2>
            <div class="slider-grid">
                <div class="slider-group"><div class="slider-header"><span>Solar PV</span><span id="v-solar">3.5 kW</span></div><input type="range" id="s-solar" min="0" max="10" step="0.1" value="3.5"></div>
                <div class="slider-group"><div class="slider-header"><span>Wind</span><span id="v-wind">1.2 kW</span></div><input type="range" id="s-wind" min="0" max="10" step="0.1" value="1.2"></div>
                <div class="slider-group"><div class="slider-header"><span>Heat Pump</span><span id="v-hp">2.0 kW</span></div><input type="range" id="s-hp" min="0" max="5" step="0.1" value="2.0"></div>
                <div class="slider-group"><div class="slider-header"><span>Battery Support</span><span id="v-batt">0.5 kW</span></div><input type="range" id="s-batt" min="-5" max="5" step="0.1" value="0.5"></div>
                <div class="slider-group"><div class="slider-header"><span>Home Consumption</span><span id="v-home">2.5 kW</span></div><input type="range" id="s-home" min="0" max="10" step="0.1" value="2.5"></div>
                <div class="slider-group"><div class="slider-header"><span>EV Charger</span><span id="v-ev">0.0 kW</span></div><input type="range" id="s-ev" min="0" max="7.4" step="0.1" value="0.0"></div>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();
        const inputs = { solar: document.getElementById('s-solar'), wind: document.getElementById('s-wind'), hp: document.getElementById('s-hp'), batt: document.getElementById('s-batt'), home: document.getElementById('s-home'), ev: document.getElementById('s-ev') };

        const updateSimulation = () => {
            const v = { s: +inputs.solar.value, w: +inputs.wind.value, hp: +inputs.hp.value, b: +inputs.batt.value, h: +inputs.home.value, ev: +inputs.ev.value };

            // Update Labels & Node Text
            for (let k in inputs) {
                const val = (k==='solar')?v.s:(k==='wind')?v.w:(k==='hp')?v.hp:(k==='batt')?v.b:(k==='home')?v.h:v.ev;
                document.getElementById(`v-${k}`).innerText = val.toFixed(1) + " kW";
                document.getElementById(`node-${k}`).querySelector('.val').innerText = val.toFixed(1);
            }

            // EV Color Logic: Red at 0, Green > 0
            const evNode = document.getElementById('node-ev');
            const evColor = v.ev > 0 ? "var(--green)" : "var(--red)";
            evNode.style.borderColor = evColor;
            evNode.querySelector('i').style.color = evColor;

            // Balance Logic
            const production = v.s + v.w + v.hp + v.b;
            const consumption = v.h + v.ev;
            const grid = consumption - production;

            // Grid Node Updates
            const gridNode = document.getElementById('node-grid');
            const gridValDisplay = gridNode.querySelector('.val');
            gridValDisplay.innerText = grid.toFixed(1);
            const statusColor = grid > 0 ? "var(--red)" : "var(--green)";
            gridValDisplay.style.color = statusColor;
            gridNode.style.borderColor = statusColor;
            gridNode.querySelector('i').style.color = statusColor;

            // Top Bar
            document.getElementById('tel-yield').innerText = (v.s + v.w + v.hp).toFixed(1) + " kW";
            const telGrid = document.getElementById('tel-grid');
            telGrid.innerText = grid.toFixed(1) + " kW";
            telGrid.style.color = statusColor;
        };

        Object.values(inputs).forEach(input => input.addEventListener('input', updateSimulation));
        updateSimulation();
    </script>
</body>
</html>
