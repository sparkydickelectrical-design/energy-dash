<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, viewport-fit=cover">
    <title>Master Hub | PeakShaving Pro</title>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="telemetry-header">
        <div class="tel-item">
            <i data-lucide="arrow-down-left" class="red-text"></i>
            <span class="tel-label">Grid Import Status</span>
            <span class="tel-val" id="header-grid">0.85 kW</span>
        </div>
        <div class="tel-item">
            <i data-lucide="zap" class="green-text"></i>
            <span class="tel-label">Active Renewable Yield</span>
            <span class="tel-val" id="header-yield">3.10 kW</span>
        </div>
    </header>

    <section class="radial-container">
        <div class="radial-dashboard">
            <svg class="connections-layer" viewBox="0 0 400 400">
                <line x1="200" y1="200" x2="200" y2="50" class="dash-line" />
                <line x1="200" y1="200" x2="330" y2="100" class="dash-line" />
                <line x1="200" y1="200" x2="350" y2="220" class="dash-line" />
                <line x1="200" y1="200" x2="280" y2="340" class="dash-line" />
                <line x1="200" y1="200" x2="120" y2="340" class="dash-line" />
                <line x1="200" y1="200" x2="50" y2="220" class="dash-line" />
                <line x1="200" y1="200" x2="70" y2="100" class="dash-line" />
            </svg>

            <div class="node-wrapper center-pos">
                <div class="node center-node"><i data-lucide="cpu" class="blue-text"></i></div>
                <span class="ext-label">CORE ACTIVE</span>
            </div>

            <div class="node-wrapper solar-pos">
                <div class="node" id="sim-solar"><i data-lucide="sun"></i><span class="v">2.4</span></div>
                <span class="ext-label">SOLAR PV</span>
            </div>
            <div class="node-wrapper wind-pos">
                <div class="node" id="sim-wind"><i data-lucide="wind"></i><span class="v">0.7</span></div>
                <span class="ext-label">WIND</span>
            </div>
            <div class="node-wrapper battery-pos">
                <div class="node" id="sim-batt"><i data-lucide="battery"></i><span class="v">-0.5</span></div>
                <span class="ext-label">STORAGE</span>
            </div>
            <div class="node-wrapper home-pos">
                <div class="node border-blue" id="sim-home"><i data-lucide="home"></i><span class="v">1.1</span></div>
                <span class="ext-label">HOME LOAD</span>
            </div>
            <div class="node-wrapper charger-pos">
                <div class="node border-green" id="sim-ev"><i data-lucide="car"></i><span class="v">0.0</span></div>
                <span class="ext-label">EV CHARGER</span>
            </div>
            <div class="node-wrapper heatpump-pos">
                <div class="node" id="sim-hp"><i data-lucide="thermometer"></i><span class="v">0.6</span></div>
                <span class="ext-label">HEAT PUMP</span>
            </div>
            <div class="node-wrapper grid-pos">
                <div class="node border-red" id="sim-grid"><i data-lucide="utility-pole"></i><span class="v">0.8</span></div>
                <span class="ext-label">UTILITY GRID</span>
            </div>
        </div>
    </section>

    <main class="scroll-content">
        <section class="section-group">
            <h1 class="section-title">Energy Storage System (ESS) Metrics</h1>
            <div class="ess-card">
                <div class="bms-status">
                    <i data-lucide="shield-check" class="green-text"></i>
                    <span>BMS Status: Nominal</span>
                </div>
                <div class="ess-metrics-list">
                    <p id="ess-soc">92% Charge</p>
                    <p>DC Voltage 54.21 V</p>
                    <p>Internal Temp 24.5 °C</p>
                    <p>Cycle Count 122</p>
                </div>
            </div>
        </section>

        <section class="section-group">
            <h2 class="section-title">24h System Accumulation</h2>
            <div class="acc-grid">
                <div class="acc-card">
                    <span class="acc-val" id="acc-solar">14.22</span>
                    <span class="acc-unit">kWh</span>
                    <div class="acc-meta"><i data-lucide="sun" class="orange-text"></i> SOLAR GENERATION</div>
                </div>
                <div class="acc-card">
                    <span class="acc-val" id="acc-home">8.45</span>
                    <span class="acc-unit">kWh</span>
                    <div class="acc-meta"><i data-lucide="home" class="blue-text"></i> HOUSEHOLD DEMAND</div>
                </div>
                <div class="acc-card">
                    <span class="acc-val">2.10</span>
                    <span class="acc-unit">kWh</span>
                    <div class="acc-meta"><i data-lucide="moon" class="muted-text"></i> OFF-PEAK IMPORT</div>
                </div>
                <div class="acc-card">
                    <span class="acc-val">0.52</span>
                    <span class="acc-unit">kWh</span>
                    <div class="acc-meta"><i data-lucide="zap-off" class="red-text"></i> PEAK COST IMPORT</div>
                </div>
            </div>
        </section>
        
        <div style="text-align: center; margin-top: 20px;">
            <a href="savings.html" style="color: var(--green); text-decoration: none; font-weight: 800; font-size: 0.8rem;">VIEW SAVINGS ANALYSIS →</a>
        </div>
    </main>

    <script>
        lucide.createIcons();
        
        function runSimulation() {
            // Update Solar Node and Accumulation
            const solarNode = document.getElementById('sim-solar').querySelector('.v');
            const accSolar = document.getElementById('acc-solar');
            const headerYield = document.getElementById('header-yield');
            
            let currentSolar = parseFloat(solarNode.innerText);
            let totalSolar = parseFloat(accSolar.innerText);
            
            // Generate fluctuations
            let flux = (Math.random() * 0.4 - 0.2);
            let newSolar = Math.max(0, currentSolar + flux);
            
            // Apply Updates
            solarNode.innerText = newSolar.toFixed(1);
            headerYield.innerText = (newSolar + 0.7).toFixed(2) + " kW"; // Solar + Wind constant
            accSolar.innerText = (totalSolar + (newSolar / 3600)).toFixed(2); // Simulating kWh gain
        }

        setInterval(runSimulation, 2000);
    </script>
</body>
</html>
